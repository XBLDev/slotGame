<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Slot Game</title>


  <style>* {padding: 0; margin: 0}</style>

</head>
  <script src="pixi.min.js"></script>
  <script src="pixi-audio.js"></script>
<body>
  <script type="text/javascript">

//Aliases
var Container = PIXI.Container,
    autoDetectRenderer = PIXI.autoDetectRenderer,
    loader = PIXI.loader,
    TextureCache = PIXI.utils.TextureCache,
    Rectangle = PIXI.Rectangle,
    resources = PIXI.loader.resources,
    Sprite = PIXI.Sprite;


var dungeon, explorer, treasure, door, id;

// var texture = TextureCache["images/tileset.png"];
// var rectangle = new Rectangle(192, 128, 64, 64);
// texture.frame = rectangle;
// var rocket = new Sprite(texture);
// rocket.x = 80;
// rocket.y = 80;

//Create the renderer
renderer = autoDetectRenderer(window.innerWidth, window.innerHeight);//256,256
renderer.view.style.border = "5px black";
renderer.backgroundColor = 0xffffff;
// renderer.autoResize = true;
// renderer.resize(512, 512);
renderer.view.style.position = "absolute";
// renderer.view.style.display = "block";
renderer.autoResize = true;
renderer.resize(window.innerWidth, window.innerHeight);


//Add the canvas to the HTML document
document.body.appendChild(renderer.view);

//Create a container object called the `stage`
var stage = new Container();
// stage.addChild(rocket);


// PIXI.loader.add([
//   {name:"AwesomeMusic", url:"./Sound/Example.ogg"}
// ]).load(function(){
//   var awesomeMusic = PIXI.audioManager.getAudio('AwesomeMusic');
//   awesomeMusic.play();
// });


var bgMusic, upButtonMusic, downButtonMusic, SpinButtonMusic;
var snowflakeWinMusic, sunWinMusic, sandglassWinMusic, victoryWinMusic, royalWinMusic;
var allWinMusic;
// http://www.bigsoundbank.com/sound-0267-sea-waves-and-seagulls.html
PIXI.loader.add([
  {name:"background", url:"./Sound/Background.ogg"}
, {name:"up", url:"./Sound/UpButtonSound.ogg"}
, {name:"down", url:"./Sound/DownButtonSound.ogg"}
, {name:"spin", url:"./Sound/SpinButtonSound.ogg"}

, {name:"royalwin", url:"./Sound/royalWinSound.ogg"}
, {name:"snowflakewin", url:"./Sound/snowflakeWinSound.ogg"}
, {name:"sunwin", url:"./Sound/SunWinSound.ogg"}
, {name:"sandglasswin", url:"./Sound/SandGlassWinSound.ogg"}
, {name:"victorywin", url:"./Sound/victoryWinSound.ogg"}


]).load(function(){
  bgMusic = PIXI.audioManager.getAudio('background');
  bgMusic.loop = true;
  // bgMusic.play();  
  upButtonMusic = PIXI.audioManager.getAudio('up');
  downButtonMusic = PIXI.audioManager.getAudio('down');
  SpinButtonMusic = PIXI.audioManager.getAudio('spin');

  royalWinMusic = PIXI.audioManager.getAudio('royalwin');
  snowflakeWinMusic = PIXI.audioManager.getAudio('snowflakewin');
  sunWinMusic = PIXI.audioManager.getAudio('sunwin');
  sandglassWinMusic = PIXI.audioManager.getAudio('sandglasswin');
  victoryWinMusic = PIXI.audioManager.getAudio('victorywin');
  allWinMusic = [snowflakeWinMusic, sunWinMusic, sandglassWinMusic, victoryWinMusic, royalWinMusic];
});


loader.add("images/treasureHunter.json").load(setupTextureAtlas);

function setupTextureAtlas()
{
  //There are 3 ways to make sprites from textures atlas frames

  //1. Access the `TextureCache` directly
  var dungeonTexture = TextureCache["dungeon.png"];
  dungeon = new Sprite(dungeonTexture);
  // stage.addChild(dungeon);

  //2. Access the texture using throuhg the loader's `resources`:
  explorer = new Sprite(
    resources["images/treasureHunter.json"].textures["explorer.png"]
  );
  explorer.x = 68;

  //Center the explorer vertically
  explorer.y = stage.height / 2 - explorer.height / 2;
  // stage.addChild(explorer);

  //3. Create an optional alias called `id` for all the texture atlas 
  //frame id textures.
  id = PIXI.loader.resources["images/treasureHunter.json"].textures; 
  
  //Make the treasure box using the alias
  treasure = new Sprite(id["treasure.png"]);
  // stage.addChild(treasure);

  //Position the treasure next to the right edge of the canvas
  treasure.x = stage.width - treasure.width - 48;
  treasure.y = stage.height / 2 - treasure.height / 2;
  // stage.addChild(treasure);

  //Make the exit door
  door = new Sprite(id["door.png"]); 
  door.position.set(32, 0);
  // stage.addChild(door);

  //Make the blobs
  var numberOfBlobs = 6,
      spacing = 48,
      xOffset = 150;

  //Make as many blobs as there are `numberOfBlobs`
  for (var i = 0; i < numberOfBlobs; i++) {

    //Make a blob
    var blob = new Sprite(id["blob.png"]);

    //Space each blob horizontally according to the `spacing` value.
    //`xOffset` determines the point from the left of the screen
    //at which the first blob should be added.
    var x = spacing * i + xOffset;

    //Give the blob a random y position
    //(`randomInt` is a custom function - see below)
    var y = randomInt(0, stage.height - blob.height);

    //Set the blob's position
    blob.x = x;
    blob.y = y;

    //Add the blob sprite to the stage
    // stage.addChild(blob);
  }

  //Render the stage   
  // renderer.render(stage);
}



loader.add("images/tileset.png").load(setupTileset);

function setupTileset() 
{

  //Create the `tileset` sprite from the texture
  var texture = TextureCache["images/tileset.png"];

  //Create a rectangle object that defines the position and
  //size of the sub-image you want to extract from the texture
  var rectangle = new Rectangle(192, 128, 64, 64);

  //Tell the texture to use that rectangular section
  texture.frame = rectangle;

  //Create the sprite from the texture
  var rocket = new Sprite(texture);

  //Position the rocket sprite on the canvas
  rocket.x = 180;
  rocket.y = 180;

  //Optionally use `pivot` to move the sprite's x and y position
  /*
  rocket.pivot.set(32, 32);
  rocket.rotation = 0.3;
  console.log(rocket.position)
  */

  //Add the rocket to the stage
  // stage.addChild(rocket);
  
  //Render the stage   
  // renderer.render(stage);
}  


var snowflakePays = [250,500,1000];
var sunPays       = [250,450,800];
var sandglassPays = [150,400,700];
var victoryPays   = [100,350,600];
var acePays       = [90,300,700];
var kingPays      = [80,250,600];
var queenPays     = [70,200,500];
var jackPays      = [60,100,400];


var paySummary = [snowflakePays, sunPays, sandglassPays, victoryPays, acePays, kingPays, queenPays, jackPays];

var linePattern1 = [2,2,2,2,2];
var linePattern2 = [1,1,1,1,1];
var linePattern3 = [3,3,3,3,3];
var linePattern4 = [1,2,3,2,1];
var linePattern5 = [3,2,1,2,3];




loader.add("images/cat.png").add("images/up.png").
add("images/down.png").add("images/snowflake.png").
add("images/sandglass.png").add("images/sun.png").
add("images/victory.png").
add("images/Ace.png").
add("images/King.png").
add("images/Queen.png").
add("images/Jack.png").
load(setup);


var linePattern1DrawStartX = 400;
var linePattern1DrawStartY = 300;
var linePattern1DrawWidth = 100;
var linePattern1DrawHeight = 100;


var cat, hedgehog, tiger, animals, upbutton, downbutton, state;
var reel1, reel2, reel3, reel4, reel5; 
var linePattern1Drawer, linePattern2Drawer, linePattern3Drawer, linePattern4Drawer, linePattern5Drawer;
var allLinePatternDrawers;
var betNum = 1;
var balanceNum = 10000;//10000
var currentSpinWin = 0;
var currentSpinPayoutTotal = 0;
var currentSpinLinePatternWithPay = [0,0,0,0,0];
var currentSpinPayFromEachPattern = [0,0,0,0,0];

var symbolNames = ["snowflake","sun","sandglass","victory","ace","king","queen","jack"];
var betNumMsg;
var balaceNumMsg;
var currentWinPriceMsg;
var reel1CurrentSymbol = 0;
var reel2CurrentSymbol = 0;
var reel3CurrentSymbol = 0;
var reel4CurrentSymbol = 0;
var reel5CurrentSymbol = 0;
var lineNumber = 3;

var showingWinLines = 0;
var showWinLineTimer = 0; 
var currentWinLines = [];
var currentShowingWinLineNum = 0;

var reel1Layout = [1,5,2,1,6,5,8,5,1,2,3,7,4,5,8,1,4,3,2,5,6];
var reel2Layout = [5,1,6,3,7,8,1,3,2,4,6,8,5,4,5,3,8,7,5,4,1,7,4,8,4];
var reel3Layout = [8,4,1,3,2,6,7,2,3,4,1,5,6,7,8,2,5,4,3,1,2,7,6,7,1,4,3,2,4];
var reel4Layout = [1,7,4,2,3,8,4,3,2,5,6,7,2,3,4,5,8,1,2,6,2,4,2,6,3,7,8,4,6,2,3,1,2,5,6,3,4];
var reel5Layout = [8,5,1];

var reel1Current3Symbols = [0,1,2];
var reel2Current3Symbols = [0,1,2];
var reel3Current3Symbols = [0,1,2];
var reel4Current3Symbols = [0,1,2];
var reel5Current3Symbols = [0,1,2];

var imageURLs = ["images/snowflake.png","images/sun.png","images/sandglass.png","images/victory.png",
                 "images/Ace.png","images/King.png","images/Queen.png","images/Jack.png"];

var spinning = 0;
var reel1CurrentSpinningNum = 0;
var reel1CurrentGeneratedSpinningRound = -1;
var reel2CurrentSpinningNum = 0;
var reel2CurrentGeneratedSpinningRound = -1;
var reel3CurrentSpinningNum = 0;
var reel3CurrentGeneratedSpinningRound = -1;
var reel4CurrentSpinningNum = 0;
var reel4CurrentGeneratedSpinningRound = -1;
var reel5CurrentSpinningNum = 0;
var reel5CurrentGeneratedSpinningRound = -1;

var currentMaxGeneratedSpinningRound = -1;

var symbolWidth = 100;//25
var symbolHeight = 100;//25
var reel1startX = 400;//50
var reel1startY = 300;
var spinBtnrectangle;

function setup(){
  // console.log("first ele: ", imageURLs[5]);

  // console.log("reel1layout length: ",reel1Layout.length);
  // console.log("reel2layout length: ",reel2Layout.length);
  // console.log("reel3layout length: ",reel3Layout.length);
  // console.log("reel4layout length: ",reel4Layout.length);
  // console.log("reel5layout length: ",reel5Layout.length);



  animals = new Container();
  reel1 = new Container();
  reel2 = new Container();
  reel3 = new Container();
  reel4 = new Container();
  reel5 = new Container();

  linePattern1Drawer = new Container();
  linePattern2Drawer = new Container();
  linePattern3Drawer = new Container();
  linePattern4Drawer = new Container();
  linePattern5Drawer = new Container();
  allLinePatternDrawers = new Container();

  for(var i=0;i<5;i++)
  {
    var rectangle = new PIXI.Graphics();
    rectangle.beginFill(0xffff00);
    rectangle.lineStyle(2, 0xffff00, 1);
    rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY + symbolHeight , linePattern1DrawWidth , linePattern1DrawHeight);
    rectangle.endFill();
    linePattern1Drawer.addChild(rectangle);
    // stage.addChild(winrectangle);    
  }
  linePattern1Drawer.visible = false;
  
  allLinePatternDrawers.addChild(linePattern1Drawer);
  // stage.addChild(linePattern1Drawer);


  for(var i=0;i<5;i++)
  {
    var rectangle = new PIXI.Graphics();
    rectangle.beginFill(0xff0000);
    rectangle.lineStyle(2, 0xff0000, 1);
    rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY , linePattern1DrawWidth , linePattern1DrawHeight);
    rectangle.endFill();
    linePattern2Drawer.addChild(rectangle);
    // stage.addChild(winrectangle);    
  }
  linePattern2Drawer.visible = false;
  
  allLinePatternDrawers.addChild(linePattern2Drawer);
  // stage.addChild(linePattern2Drawer);

  for(var i=0;i<5;i++)
  {
    var rectangle = new PIXI.Graphics();
    rectangle.beginFill(0x00ff00);
    rectangle.lineStyle(2, 0x00ff00, 1);
    rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY + symbolHeight * 2, linePattern1DrawWidth , linePattern1DrawHeight);
    rectangle.endFill();
    linePattern3Drawer.addChild(rectangle);
    // stage.addChild(winrectangle);    
  }
  linePattern3Drawer.visible = false;
  
  allLinePatternDrawers.addChild(linePattern3Drawer);
  // stage.addChild(linePattern3Drawer);

  for(var i=0;i<5;i++)
  {
    var rectangle = new PIXI.Graphics();
    rectangle.beginFill(0xFF4500);
    rectangle.lineStyle(2, 0xFF4500	, 1);
    if(i==0 || i==4)
    {
      rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY, linePattern1DrawWidth , linePattern1DrawHeight);
    }
    else if(i==1 || i==3)
    {
      rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY + symbolHeight, linePattern1DrawWidth , linePattern1DrawHeight);
    }
    else
    {
      rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY + symbolHeight * 2, linePattern1DrawWidth , linePattern1DrawHeight);
    }

    rectangle.endFill();
    linePattern4Drawer.addChild(rectangle);
    // stage.addChild(winrectangle);    
  }
    linePattern4Drawer.visible = false;

  allLinePatternDrawers.addChild(linePattern4Drawer);  
  // stage.addChild(linePattern4Drawer);

  for(var i=0;i<5;i++)
  {
    var rectangle = new PIXI.Graphics();
    rectangle.beginFill(0x006400);
    rectangle.lineStyle(2, 0x006400	, 1);
    if(i==0 || i==4)
    {
      rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY + symbolHeight * 2, linePattern1DrawWidth , linePattern1DrawHeight);
    }
    else if(i==1 || i==3)
    {
      rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY + symbolHeight, linePattern1DrawWidth , linePattern1DrawHeight);
    }
    else
    {
      rectangle.drawRect(linePattern1DrawStartX + i * linePattern1DrawWidth, reel1startY, linePattern1DrawWidth , linePattern1DrawHeight);
    }

    rectangle.endFill();
    linePattern5Drawer.addChild(rectangle);
    // stage.addChild(winrectangle);    
  }
  linePattern5Drawer.visible = false;
  allLinePatternDrawers.addChild(linePattern5Drawer);


  stage.addChild(allLinePatternDrawers);



  for(var i=0; i< reel1Layout.length;i++)
  {
    var currentSymbolNum = reel1Layout[i];
    var currentSymbol =  new Sprite(resources[imageURLs[currentSymbolNum-1]].texture);
    currentSymbol.width = symbolWidth;
    currentSymbol.height = symbolHeight;
    currentSymbol.x = reel1startX;
    currentSymbol.y = reel1startY + i * symbolHeight;
    if(i==0 || i==1 || i==2)
    {
      currentSymbol.visible = true;
    }
    else
    {
      currentSymbol.visible = false;
    }    
    reel1.addChild(currentSymbol);
    // console.log("ele: ", reel1Layout[i]);
  }
  // console.log("reel1 length: ", reel1.children.length);


  for(var i=0; i< reel2Layout.length;i++)
  {
    var currentSymbolNum = reel2Layout[i];
    var currentSymbol =  new Sprite(resources[imageURLs[currentSymbolNum-1]].texture);
    currentSymbol.width = symbolWidth;
    currentSymbol.height = symbolHeight;
    currentSymbol.x = reel1startX + symbolWidth * 1;
    currentSymbol.y = reel1startY + i * symbolHeight;
    if(i==0 || i==1 || i==2)
    {
      currentSymbol.visible = true;
    }
    else
    {
      currentSymbol.visible = false;
    }


    reel2.addChild(currentSymbol);
    // console.log("ele: ", reel1Layout[i]);
  }
  // console.log("reel2 length: ", reel2.children.length);

  for(var i=0; i< reel3Layout.length;i++)
  {
    var currentSymbolNum = reel3Layout[i];
    var currentSymbol =  new Sprite(resources[imageURLs[currentSymbolNum-1]].texture);
    currentSymbol.width = symbolWidth;
    currentSymbol.height = symbolHeight;
    currentSymbol.x = reel1startX + symbolWidth * 2;
    currentSymbol.y = reel1startY + i * symbolHeight;
    if(i==0 || i==1 || i==2)
    {
      currentSymbol.visible = true;
    }
    else
    {
      currentSymbol.visible = false;
    }


    reel3.addChild(currentSymbol);
    // console.log("ele: ", reel1Layout[i]);
  }
  // console.log("reel3 length: ", reel3.children.length);


  for(var i=0; i< reel4Layout.length;i++)
  {
    var currentSymbolNum = reel4Layout[i];
    var currentSymbol =  new Sprite(resources[imageURLs[currentSymbolNum-1]].texture);
    currentSymbol.width = symbolWidth;
    currentSymbol.height = symbolHeight;
    currentSymbol.x = reel1startX + symbolWidth * 3;
    currentSymbol.y = reel1startY + i * symbolHeight;
    if(i==0 || i==1 || i==2)
    {
      currentSymbol.visible = true;
    }
    else
    {
      currentSymbol.visible = false;
    }


    reel4.addChild(currentSymbol);
    // console.log("ele: ", reel1Layout[i]);
  }  
  // console.log("reel4 length: ", reel4.children.length);

  for(var i=0; i< reel5Layout.length;i++)
  {
    var currentSymbolNum = reel5Layout[i];
    var currentSymbol =  new Sprite(resources[imageURLs[currentSymbolNum-1]].texture);
    currentSymbol.width = symbolWidth;
    currentSymbol.height = symbolHeight;
    currentSymbol.x = reel1startX + symbolWidth * 4;
    currentSymbol.y = reel1startY + i * symbolHeight;
    if(i==0 || i==1 || i==2)
    {
      currentSymbol.visible = true;
    }
    else
    {
      currentSymbol.visible = false;
    }


    reel5.addChild(currentSymbol);
    // console.log("ele: ", reel1Layout[i]);
  }    
  // console.log("reel5 length: ", reel5.children.length);








  stage.addChild(reel1);
  stage.addChild(reel2);
  stage.addChild(reel3);
  stage.addChild(reel4);
  stage.addChild(reel5);




  cat = new Sprite(resources["images/cat.png"].texture);
  //Change the sprite's position
  cat.x = 96;
  cat.y = 96;
  //Change the sprite's size
  cat.width = 80;
  cat.height = 120;
  cat.scale.set(2, 2);

  // Opt-in to interactivity
  cat.interactive = true;
// Shows hand cursor
  cat.buttonMode = true;
  // cat.on('pointerdown',onClick);
  // sprite.on('tap', onClick); // touch-only
  cat.on('click', onClick); // mouse-only

  // cat.anchor.x = 0.5;
  // cat.anchor.y = 0.5;
  // cat.rotation = 0.5;
  //Initialize the cat's velocity variables
  // cat.vx = 0;
  // cat.vy = 0;

  //The hedgehog
  hedgehog = new Sprite(resources["images/cat.png"].texture);
  // hedgehog.position.set(116, 116);
  hedgehog.x = 126;
  hedgehog.y = 126;
  hedgehog.width = 80;
  hedgehog.height = 120;

  //The tiger
  tiger = new Sprite(resources["images/cat.png"].texture);
  // tiger.position.set(136, 136);
  tiger.x = 156;
  tiger.y = 156;  
  tiger.width = 80;
  tiger.height = 120;

  // animals.addChild(cat);
  // animals.addChild(hedgehog);
  // animals.addChild(tiger);
  // animals.x = 100;
  // animals.y = 100;
  // animals.vx = 0;
  // animals.vy = 0;


// var sprite = PIXI.Sprite.fromImage('required/assets/basics/bunny.png');
// http://www.riocog.org/Pics/UpArrow.jpg
  // upButton = PIXI.Sprite.fromImage('images/upButtonImg.png');
  upbutton = new Sprite(resources["images/up.png"].texture);
  upbutton.x = 350;
  upbutton.y = 500+300;
  upbutton.width = 80;//80
  upbutton.height = 100;//100
  upbutton.interactive = true;
  upbutton.buttonMode = true;
  upbutton.on('click', onClickUp); // mouse-only
  stage.addChild(upbutton);

  downbutton = new Sprite(resources["images/down.png"].texture);
  downbutton.x = 350;
  downbutton.y = 500 + 100+300;
  downbutton.width = 80;//80
  downbutton.height = 100;//100
  downbutton.interactive = true;
  downbutton.buttonMode = true;
  downbutton.on('click', onClickDown); // mouse-only  
  stage.addChild(downbutton);
  

  // stage.addChild(animals);
  // renderer.render(stage);
  var message = new PIXI.Text("WIN",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  message.style = {wordWrap: true, wordWrapWidth: 50, wordWrapHeight: 32};
  message.position.set(500+150-25, 50-16);

  currentWinPriceMsg = new PIXI.Text("$"+currentSpinWin+".00",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  currentWinPriceMsg.style = {wordWrap: true, wordWrapWidth: 50, wordWrapHeight: 32};
  currentWinPriceMsg.position.set(500+150-25, 150-16);

  var balanceMsg = new PIXI.Text("BALANCE",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  balanceMsg.style = {wordWrap: true, wordWrapWidth: 100, wordWrapHeight: 32};
  balanceMsg.position.set(500+150-50, 50-16+500+300);

  balaceNumMsg = new PIXI.Text("$"+balanceNum+".00",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  balaceNumMsg.style = {wordWrap: true, wordWrapWidth: 100, wordWrapHeight: 32};
  balaceNumMsg.position.set(500+150-50, 150-16+500+300);

  var betMsg = new PIXI.Text("BET",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  betMsg.style = {wordWrap: true, wordWrapWidth: 50, wordWrapHeight: 32};
  betMsg.position.set(50 + 150-25, 50-16+500+300);

  betNumMsg = new PIXI.Text("$"+betNum+".00",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  betNumMsg.style = {wordWrap: true, wordWrapWidth: 50, wordWrapHeight: 32};
  betNumMsg.position.set(50 + 150-25, 150-16+500+300);

  spinBtntext = new PIXI.Text("SPIN",{fontFamily: "Arial", fontSize: 32, fill: "black"});
  spinBtntext.style = {wordWrap: true, wordWrapWidth: 50, wordWrapHeight: 32};
  spinBtntext.position.set(950 + 150-25, 600-16+300);

  // message.x = 54;
  // message.y = 96;

  var winrectangle = new PIXI.Graphics();
  winrectangle.beginFill(0xD3D3D3);
  winrectangle.lineStyle(2, 0x000000, 1);
  winrectangle.drawRect(500,0,300,100);
  winrectangle.endFill();
  stage.addChild(winrectangle);

  var winPriceRectangle = new PIXI.Graphics();
  winrectangle.beginFill(0xFFFFFF);
  winrectangle.lineStyle(2, 0x000000, 1);
  winrectangle.drawRect(500,100,300,100);
  winrectangle.endFill();
  stage.addChild(winrectangle);

  var balancerectangle = new PIXI.Graphics();
  balancerectangle.beginFill(0xD3D3D3);
  balancerectangle.lineStyle(2, 0x000000, 1);
  balancerectangle.drawRect(500,0 + 500+300,300,100);
  balancerectangle.endFill();
  stage.addChild(balancerectangle);

  var balanceNumrectangle = new PIXI.Graphics();
  balanceNumrectangle.beginFill(0xFFFFFF);
  balanceNumrectangle.lineStyle(2, 0x000000, 1);
  balanceNumrectangle.drawRect(500,100+500+300,300,100);
  balanceNumrectangle.endFill();
  stage.addChild(balanceNumrectangle);

  var betrectangle = new PIXI.Graphics();
  betrectangle.beginFill(0xD3D3D3);
  betrectangle.lineStyle(2, 0x000000, 1);
  betrectangle.drawRect(50,0 + 500+300,300,100);
  betrectangle.endFill();
  stage.addChild(betrectangle);

  var betNumrectangle = new PIXI.Graphics();
  betNumrectangle.beginFill(0xFFFFFF);
  betNumrectangle.lineStyle(2, 0x000000, 1);
  betNumrectangle.drawRect(50,100+500+300,300,100);
  betNumrectangle.endFill();
  stage.addChild(betNumrectangle);

  spinBtnrectangle = new PIXI.Graphics();
  spinBtnrectangle.beginFill(0xD3D3D3);
  spinBtnrectangle.lineStyle(2, 0x000000, 1);
  spinBtnrectangle.drawRect(950,0+500+300,300,200);
  spinBtnrectangle.endFill();
  spinBtnrectangle.interactive = true;
  spinBtnrectangle.buttonMode = true;
  spinBtnrectangle.on('click', onClickSpin); // mouse-only  
  stage.addChild(spinBtnrectangle);



  stage.addChild(message);
  stage.addChild(currentWinPriceMsg);
  stage.addChild(balanceMsg);
  stage.addChild(balaceNumMsg);
  stage.addChild(betMsg);
  stage.addChild(betNumMsg);
  stage.addChild(spinBtntext);

  
  state = play;
  // //Capture the keyboard arrow keys
  // var left = keyboard(37),
  //     up = keyboard(38),
  //     right = keyboard(39),
  //     down = keyboard(40);

  // //Left arrow key `press` method
  // left.press = function() {

  //   //Change the cat's velocity when the key is pressed
  //   animals.vx = -5;
  //   animals.vy = 0;
  // };

  // //Left arrow key `release` method
  // left.release = function() {

  //   //If the left arrow has been released, and the right arrow isn't down,
  //   //and the cat isn't moving vertically:
  //   //Stop the cat
  //   if (!right.isDown && animals.vy === 0) {
  //     animals.vx = 0;
  //   }
  // };

  // //Up
  // up.press = function() {
  //   animals.vy = -5;
  //   animals.vx = 0;
  // };
  // up.release = function() {
  //   if (!down.isDown && animals.vx === 0) {
  //     animals.vy = 0;
  //   }
  // };

  // //Right
  // right.press = function() {
  //   animals.vx = 5;
  //   animals.vy = 0;
  // };
  // right.release = function() {
  //   if (!left.isDown && animals.vy === 0) {
  //     animals.vx = 0;
  //   }
  // };

  // //Down
  // down.press = function() {
  //   animals.vy = 5;
  //   animals.vx = 0;
  // };
  // down.release = function() {
  //   if (!up.isDown && animals.vx === 0) {
  //     animals.vy = 0;
  //   }
  // };  

  // renderer.render(stage);
  gameLoop();
}

  // renderer.render(stage);




function gameLoop() {

  //Loop this function at 60 frames per second
  requestAnimationFrame(gameLoop);
  state();

  // cat.vx = 1;
  // cat.vy = 1;

  // //Move the cat 1 pixel to the right each frame
  // cat.x += cat.vx;
  // cat.y += cat.vy;
  //Render the stage to see the animation
  renderer.render(stage);
}


function play()
{



  // console.log("reel1CurrentSymbol: "+reel1CurrentSymbol);
  for(var i=0;i<reel1.children.length;i++)
  {




    var temp = reel1.children[i];

    // if(i in reel1Current3Symbols)
    // {
    //   temp.visible = true;
    // }
    // else{
    //   temp.visible = false;
    // }

    if(i == reel1Current3Symbols[0])
    {
      temp.visible = true;
      temp.y = reel1startY;
    }
    else if(i == reel1Current3Symbols[1])
    {
      temp.visible = true;
      temp.y = reel1startY + symbolHeight;
    }
    else if(i == reel1Current3Symbols[2])
    {
      temp.visible = true;
      temp.y = reel1startY + symbolHeight * 2;      
    }
    else
    {
      temp.visible = false;
    }
    // console.log("x: "+temp.x);
  }



  for(var i=0;i<reel2.children.length;i++)
  {
    var temp = reel2.children[i];

    if(i == reel2Current3Symbols[0])
    {
      temp.visible = true;
            temp.y = reel1startY;
    }
    else if(i == reel2Current3Symbols[1])
    {
      temp.visible = true;
            temp.y = reel1startY + symbolHeight;

    }
    else if(i == reel2Current3Symbols[2])
    {
      temp.visible = true;
            temp.y = reel1startY + symbolHeight * 2;      

    }
    else
    {
      temp.visible = false;
    }
    // console.log("x: "+temp.x);
  }  


  for(var i=0;i<reel3.children.length;i++)
  {
    var temp = reel3.children[i];
    if(i == reel3Current3Symbols[0])
    {
      temp.visible = true;
                  temp.y = reel1startY;

    }
    else if(i == reel3Current3Symbols[1])
    {
      temp.visible = true;
                  temp.y = reel1startY + symbolHeight;

    }
    else if(i == reel3Current3Symbols[2])
    {
      temp.visible = true;
                  temp.y = reel1startY + symbolHeight * 2;      

    }
    else
    {
      temp.visible = false;
    }
    // console.log("x: "+temp.x);
  }  

  for(var i=0;i<reel4.children.length;i++)
  {
    var temp = reel4.children[i];
    if(i == reel4Current3Symbols[0])
    {
      temp.visible = true;
      temp.y = reel1startY;

    }
    else if(i == reel4Current3Symbols[1])
    {
      temp.visible = true;
      temp.y = reel1startY + symbolHeight;

    }
    else if(i == reel4Current3Symbols[2])
    {
      temp.visible = true;
      temp.y = reel1startY + symbolHeight * 2;      

    }
    else
    {
      temp.visible = false;
    }
    // console.log("x: "+temp.x);
  }  

  for(var i=0;i<reel5.children.length;i++)
  {
    var temp = reel5.children[i];
    if(i == reel5Current3Symbols[0])
    {
      temp.visible = true;
      temp.y = reel1startY;

    }
    else if(i == reel5Current3Symbols[1])
    {
      temp.visible = true;
      temp.y = reel1startY + symbolHeight;

    }
    else if(i == reel5Current3Symbols[2])
    {
      temp.visible = true;
      temp.y = reel1startY + symbolHeight * 2;      

    }
    else
    {
      temp.visible = false;
    }
    // console.log("x: "+temp.x);
  }  


  if(spinning == 1)
  {
    spinBtnrectangle.interactive = false;
    spinBtnrectangle.buttonMode = false;
    //REEL 1
    if(reel1CurrentSpinningNum < reel1CurrentGeneratedSpinningRound)
    {
        // console.log(reel1CurrentSymbol);

        // console.log(reel1CurrentSpinningNum);
        if(reel1CurrentSymbol == reel1.children.length - 1)
        {
          reel1Current3Symbols = [0,1,2];
          reel1CurrentSymbol = 0;
        }
        else if(reel1CurrentSymbol == reel1.children.length - 2)
        {
          reel1Current3Symbols = [reel1.children.length-1,0,1];
          reel1CurrentSymbol = reel1.children.length - 1;

        }
        else if(reel1CurrentSymbol == reel1.children.length - 3)
        {
          reel1Current3Symbols = [reel1.children.length-2,reel1.children.length-1,0];
          reel1CurrentSymbol = reel1.children.length - 2;
        }
        else
        {
          reel1Current3Symbols = [reel1CurrentSymbol+1,reel1CurrentSymbol+2,reel1CurrentSymbol+3];
          reel1CurrentSymbol =  reel1CurrentSymbol + 1;
        }
        reel1CurrentSpinningNum = reel1CurrentSpinningNum + 1;
    }
    else
    {
        // console.log("reel 1 finished spinning!");
    }

    //REEL 2
    if(reel2CurrentSpinningNum < reel2CurrentGeneratedSpinningRound)
    {
        if(reel2CurrentSymbol == reel2.children.length - 1)
        {
          reel2Current3Symbols = [0,1,2];
          reel2CurrentSymbol = 0;
        }
        else if(reel2CurrentSymbol == reel2.children.length - 2)
        {
          reel2Current3Symbols = [reel2.children.length-1,0,1];
          reel2CurrentSymbol = reel2.children.length - 1;

        }
        else if(reel2CurrentSymbol == reel2.children.length - 3)
        {
          reel2Current3Symbols = [reel2.children.length-2,reel2.children.length-1,0];
          reel2CurrentSymbol = reel2.children.length - 2;
        }
        else
        {
          reel2Current3Symbols = [reel2CurrentSymbol+1,reel2CurrentSymbol+2,reel2CurrentSymbol+3];
          reel2CurrentSymbol =  reel2CurrentSymbol + 1;
        }

        reel2CurrentSpinningNum = reel2CurrentSpinningNum + 1;

    }
    else
    {
        // console.log("reel 2 finished spinning!");

    }
    //REEL 3
    if(reel3CurrentSpinningNum < reel3CurrentGeneratedSpinningRound)
    {
        if(reel3CurrentSymbol == reel3.children.length - 1)
        {
          reel3Current3Symbols = [0,1,2];
          reel3CurrentSymbol = 0;
        }
        else if(reel3CurrentSymbol == reel3.children.length - 2)
        {
          reel3Current3Symbols = [reel3.children.length-1,0,1];
          reel3CurrentSymbol = reel3.children.length - 1;

        }
        else if(reel3CurrentSymbol == reel3.children.length - 3)
        {
          reel3Current3Symbols = [reel3.children.length-2,reel3.children.length-1,0];
          reel3CurrentSymbol = reel3.children.length - 2;
        }
        else
        {
          reel3Current3Symbols = [reel3CurrentSymbol+1,reel3CurrentSymbol+2,reel3CurrentSymbol+3];
          reel3CurrentSymbol =  reel3CurrentSymbol + 1;
        }

        reel3CurrentSpinningNum = reel3CurrentSpinningNum + 1; 
    }
    else
    {
        // console.log("reel 3 finished spinning!");

    }
    //REEL 4
    if(reel4CurrentSpinningNum < reel4CurrentGeneratedSpinningRound)
    {
        if(reel4CurrentSymbol == reel4.children.length - 1)
        {
          reel4Current3Symbols = [0,1,2];
          reel4CurrentSymbol = 0;
        }
        else if(reel4CurrentSymbol == reel4.children.length - 2)
        {
          reel4Current3Symbols = [reel4.children.length-1,0,1];
          reel4CurrentSymbol = reel4.children.length - 1;

        }
        else if(reel4CurrentSymbol == reel4.children.length - 3)
        {
          reel4Current3Symbols = [reel4.children.length-2,reel4.children.length-1,0];
          reel4CurrentSymbol = reel4.children.length - 2;
        }
        else
        {
          reel4Current3Symbols = [reel4CurrentSymbol+1,reel4CurrentSymbol+2,reel4CurrentSymbol+3];
          reel4CurrentSymbol =  reel4CurrentSymbol + 1;
        }
        reel4CurrentSpinningNum = reel4CurrentSpinningNum + 1;
    }
    else
    {
        // console.log("reel 4 finished spinning!");

    }
    //REEL 5
    if(reel5CurrentSpinningNum < reel5CurrentGeneratedSpinningRound)
    {

        if(reel5CurrentSymbol == reel5.children.length - 1)
        {
          reel5Current3Symbols = [0,1,2];
          reel5CurrentSymbol = 0;
        }
        else if(reel5CurrentSymbol == reel5.children.length - 2)
        {
          reel5Current3Symbols = [reel5.children.length-1,0,1];
          reel5CurrentSymbol = reel5.children.length - 1;

        }
        else if(reel5CurrentSymbol == reel5.children.length - 3)
        {
          reel5Current3Symbols = [reel5.children.length-2,reel5.children.length-1,0];
          reel5CurrentSymbol = reel5.children.length - 2;
        }
        else
        {
          reel5Current3Symbols = [reel5CurrentSymbol+1,reel5CurrentSymbol+2,reel5CurrentSymbol+3];
          reel5CurrentSymbol =  reel5CurrentSymbol + 1;
        }
        reel5CurrentSpinningNum = reel5CurrentSpinningNum + 1;
    }
    else
    {
        // console.log("reel 5 finished spinning!");
    }

    if(reel1CurrentSpinningNum == reel1CurrentGeneratedSpinningRound
    && reel2CurrentSpinningNum == reel2CurrentGeneratedSpinningRound
    && reel3CurrentSpinningNum == reel3CurrentGeneratedSpinningRound 
    && reel4CurrentSpinningNum == reel4CurrentGeneratedSpinningRound   
    && reel5CurrentSpinningNum == reel5CurrentGeneratedSpinningRound
    )
    {

        console.log("All reels reached max spinning count!");

        reel1CurrentSpinningNum = 0;
        reel2CurrentSpinningNum = 0;
        reel3CurrentSpinningNum = 0;
        reel4CurrentSpinningNum = 0;
        reel5CurrentSpinningNum = 0;

        var currentLinePattern1 = [0,0,0,0,0];
        currentLinePattern1[0] = reel1Current3Symbols[1];
        currentLinePattern1[1] = reel2Current3Symbols[1];
        currentLinePattern1[2] = reel3Current3Symbols[1];
        currentLinePattern1[3] = reel4Current3Symbols[1];
        currentLinePattern1[4] = reel5Current3Symbols[1];
        var currentLinePattern1Symbols = [0,0,0,0,0];
        currentLinePattern1Symbols[0] = reel1Layout[reel1Current3Symbols[1]];
        currentLinePattern1Symbols[1] = reel2Layout[reel2Current3Symbols[1]];
        currentLinePattern1Symbols[2] = reel3Layout[reel3Current3Symbols[1]];
        currentLinePattern1Symbols[3] = reel4Layout[reel4Current3Symbols[1]];
        currentLinePattern1Symbols[4] = reel5Layout[reel5Current3Symbols[1]];       
        // console.log(currentLinePattern1Symbols);

        var currentLinePattern2 = [0,0,0,0,0];
        currentLinePattern2[0] = reel1Current3Symbols[0];
        currentLinePattern2[1] = reel2Current3Symbols[0];
        currentLinePattern2[2] = reel3Current3Symbols[0];
        currentLinePattern2[3] = reel4Current3Symbols[0];
        currentLinePattern2[4] = reel5Current3Symbols[0];
        var currentLinePattern2Symbols = [0,0,0,0,0];
        currentLinePattern2Symbols[0] = reel1Layout[reel1Current3Symbols[0]];
        currentLinePattern2Symbols[1] = reel2Layout[reel2Current3Symbols[0]];
        currentLinePattern2Symbols[2] = reel3Layout[reel3Current3Symbols[0]];
        currentLinePattern2Symbols[3] = reel4Layout[reel4Current3Symbols[0]];
        currentLinePattern2Symbols[4] = reel5Layout[reel5Current3Symbols[0]];       
        // console.log(currentLinePattern2Symbols);


        var currentLinePattern3 = [0,0,0,0,0];
        currentLinePattern3[0] = reel1Current3Symbols[2];
        currentLinePattern3[1] = reel2Current3Symbols[2];
        currentLinePattern3[2] = reel3Current3Symbols[2];
        currentLinePattern3[3] = reel4Current3Symbols[2];
        currentLinePattern3[4] = reel5Current3Symbols[2];
        var currentLinePattern3Symbols = [0,0,0,0,0];
        currentLinePattern3Symbols[0] = reel1Layout[reel1Current3Symbols[2]];
        currentLinePattern3Symbols[1] = reel2Layout[reel2Current3Symbols[2]];
        currentLinePattern3Symbols[2] = reel3Layout[reel3Current3Symbols[2]];
        currentLinePattern3Symbols[3] = reel4Layout[reel4Current3Symbols[2]];
        currentLinePattern3Symbols[4] = reel5Layout[reel5Current3Symbols[2]];       
        // console.log(currentLinePattern3Symbols);        

        var currentLinePattern4 = [0,0,0,0,0];
        currentLinePattern4[0] = reel1Current3Symbols[0];
        currentLinePattern4[1] = reel2Current3Symbols[1];
        currentLinePattern4[2] = reel3Current3Symbols[2];
        currentLinePattern4[3] = reel4Current3Symbols[1];
        currentLinePattern4[4] = reel5Current3Symbols[0];
        var currentLinePattern4Symbols = [0,0,0,0,0];
        currentLinePattern4Symbols[0] = reel1Layout[reel1Current3Symbols[0]];
        currentLinePattern4Symbols[1] = reel2Layout[reel2Current3Symbols[1]];
        currentLinePattern4Symbols[2] = reel3Layout[reel3Current3Symbols[2]];
        currentLinePattern4Symbols[3] = reel4Layout[reel4Current3Symbols[1]];
        currentLinePattern4Symbols[4] = reel5Layout[reel5Current3Symbols[0]];       
        // console.log(currentLinePattern4Symbols);              

        var currentLinePattern5 = [0,0,0,0,0];
        currentLinePattern5[0] = reel1Current3Symbols[2];
        currentLinePattern5[1] = reel2Current3Symbols[1];
        currentLinePattern5[2] = reel3Current3Symbols[0];
        currentLinePattern5[3] = reel4Current3Symbols[1];
        currentLinePattern5[4] = reel5Current3Symbols[2];
        var currentLinePattern5Symbols = [0,0,0,0,0];
        currentLinePattern5Symbols[0] = reel1Layout[reel1Current3Symbols[2]];
        currentLinePattern5Symbols[1] = reel2Layout[reel2Current3Symbols[1]];
        currentLinePattern5Symbols[2] = reel3Layout[reel3Current3Symbols[0]];
        currentLinePattern5Symbols[3] = reel4Layout[reel4Current3Symbols[1]];
        currentLinePattern5Symbols[4] = reel5Layout[reel5Current3Symbols[2]];       
        // console.log(currentLinePattern5Symbols);                 

        // console.log("reel1 current3: ",
        // reel1Current3Symbols[0],", ",
        // reel1Current3Symbols[1],", ",
        // reel1Current3Symbols[2],", ",
        // );

        // console.log("reel1 current3: ",
        // reel1Layout[reel1Current3Symbols[0]],", ",
        // reel1Layout[reel1Current3Symbols[1]],", ",
        // reel1Layout[reel1Current3Symbols[2]],", ",
        // );

        // console.log("reel1 current3: ",
        // symbolNames[reel1Layout[reel1Current3Symbols[0]]],", ",
        // symbolNames[reel1Layout[reel1Current3Symbols[1]]],", ",
        // symbolNames[reel1Layout[reel1Current3Symbols[2]]],", ",
        // );

        // console.log(reel1Layout);
        // console.log(reel2Layout);
        // console.log(reel3Layout);
        // console.log(reel4Layout);
        // console.log(reel5Layout);
        // var temp = currentLinePattern1[0];
        // var temp2 = currentLinePattern1[1];

        // console.log("pattern1 symbol positions: ",
        // currentLinePattern1[0],", ",
        // currentLinePattern1[1],", ",
        // currentLinePattern1[2],", ",
        // currentLinePattern1[3],", ",
        // currentLinePattern1[4]
        // );

        // console.log("pattern1 symbol numbers: ",
        // reel1Layout[currentLinePattern1[0]],", ",
        // reel2Layout[currentLinePattern1[1]],", ",
        // reel3Layout[currentLinePattern1[2]],", ",
        // reel4Layout[currentLinePattern1[3]],", ",
        // reel5Layout[currentLinePattern1[4]]
        // );
        // var temp2 = reel1Layout[temp] - 1 ;
        // console.log("pattern1 symbol names: ",
        // symbolNames[reel1Layout[currentLinePattern1[0]]-1],", ",
        // symbolNames[reel2Layout[currentLinePattern1[1]]-1],", ",
        // symbolNames[reel3Layout[currentLinePattern1[2]]-1],", ",
        // symbolNames[reel4Layout[currentLinePattern1[3]]-1],", ",
        // symbolNames[reel5Layout[currentLinePattern1[4]]-1]
        // );

        // console.log("pattern2 symbol names: ",
        // symbolNames[reel1Layout[currentLinePattern2[0]]-1],", ",
        // symbolNames[reel2Layout[currentLinePattern2[1]]-1],", ",
        // symbolNames[reel3Layout[currentLinePattern2[2]]-1],", ",
        // symbolNames[reel4Layout[currentLinePattern2[3]]-1],", ",
        // symbolNames[reel5Layout[currentLinePattern2[4]]-1]
        // );

        // console.log("pattern3 symbol names: ",
        // symbolNames[reel1Layout[currentLinePattern3[0]]-1],", ",
        // symbolNames[reel2Layout[currentLinePattern3[1]]-1],", ",
        // symbolNames[reel3Layout[currentLinePattern3[2]]-1],", ",
        // symbolNames[reel4Layout[currentLinePattern3[3]]-1],", ",
        // symbolNames[reel5Layout[currentLinePattern3[4]]-1]
        // );

        // console.log("pattern4 symbol names: ",
        // symbolNames[reel1Layout[currentLinePattern4[0]]-1],", ",
        // symbolNames[reel2Layout[currentLinePattern4[1]]-1],", ",
        // symbolNames[reel3Layout[currentLinePattern4[2]]-1],", ",
        // symbolNames[reel4Layout[currentLinePattern4[3]]-1],", ",
        // symbolNames[reel5Layout[currentLinePattern4[4]]-1]
        // );      

        // console.log("pattern5 symbol names: ",
        // symbolNames[reel1Layout[currentLinePattern5[0]]-1],", ",
        // symbolNames[reel2Layout[currentLinePattern5[1]]-1],", ",
        // symbolNames[reel3Layout[currentLinePattern5[2]]-1],", ",
        // symbolNames[reel4Layout[currentLinePattern5[3]]-1],", ",
        // symbolNames[reel5Layout[currentLinePattern5[4]]-1]
        // );             

        // console.log("pattern2: ",
        // symbolNames[reel2Layout[currentLinePattern2[0]]],", ",
        // symbolNames[reel2Layout[currentLinePattern2[1]]],", ",
        // symbolNames[reel2Layout[currentLinePattern2[2]]],", ",
        // symbolNames[reel2Layout[currentLinePattern2[3]]],", ",
        // symbolNames[reel2Layout[currentLinePattern2[4]]]
        // );
        
        // console.log("pattern3: ",
        // symbolNames[reel3Layout[currentLinePattern3[0]]],", ",
        // symbolNames[reel3Layout[currentLinePattern3[1]]],", ",
        // symbolNames[reel3Layout[currentLinePattern3[2]]],", ",
        // symbolNames[reel3Layout[currentLinePattern3[3]]],", ",
        // symbolNames[reel3Layout[currentLinePattern3[4]]]
        // );

                       
        var allLinePatternSymbols = [currentLinePattern1Symbols, 
        currentLinePattern2Symbols, currentLinePattern3Symbols, 
        currentLinePattern4Symbols, currentLinePattern5Symbols,];
        
        var allLinePatterns = [currentLinePattern1, currentLinePattern2,currentLinePattern3,currentLinePattern4,currentLinePattern5];
        var allreelLayout = [reel1Layout, reel2Layout, reel3Layout, reel4Layout, reel5Layout];
        var numberOfSnowFlake = 0;
        var numberOfSun = 0;
        var numberOfSandglass = 0;
        var numberOfVictory = 0;
        var numberOfAce = 0;
        var numberOfKing = 0;
        var numberOfQueen = 0;
        var numberOfJack = 0;
        var numberOfEachSymbol = [0,0,0,0,0,0,0,0];
        var possibleSymbolValueNum = 8;
        // var WinLine = [];


        for(var i = 0; i < allLinePatternSymbols.length;i++)
        {
            for(var a = 0; a < allLinePatternSymbols[i].length; a++)
            {
                for(var c = 0; c < possibleSymbolValueNum; c++)
                {
                    if(allLinePatternSymbols[i][a] == c+1)
                    {
                        numberOfEachSymbol[c] = numberOfEachSymbol[c] + 1;
                        // break;
                    }                    
                } 
            }

            var hasPay = 0;
            for(var d = 0; d< numberOfEachSymbol.length; d++)
            {
                if(numberOfEachSymbol[d] >=3)
                {
                  currentWinLines.push(i);
                  showingWinLines = 1;
                  // hasPay = 1;
                   //allreelLayout   
                   //currentSpinPayoutTotal 
                   payout = paySummary[d][numberOfEachSymbol[d]-3]
                   console.log("pattern ",i+1,
                               " has one symbol of number more than 3: ",symbolNames[d],
                               ", count: ", numberOfEachSymbol[d],
                               ", payout is: ", payout);

                   currentSpinPayoutTotal = currentSpinPayoutTotal + payout;

                  //  if(d<=3)
                  //  {
                  //     allWinMusic[d].play();
                  //  }
                  //  else
                  //  {
                  //     allWinMusic[4].play();

                  //  }
                   break; 
                }
            }            


            // if(hasPay == 1)
            // {
            //   currentWinLines.push(i);
            //   // WinLine[i] = 1;
            //   //  allLinePatternDrawers.children[i].visible = true;
            //   // for(var d =0; d < allLinePatternDrawers.children.length; d++)
            //   // {
            //   //     if(d == i)
            //   //     {
            //   //       allLinePatternDrawers.children[d].visible = true;

            //   //     }
            //   //     else
            //   //     {
            //   //       allLinePatternDrawers.children[d].visible = false;

            //   //     }
            //   // }
            // }
            numberOfEachSymbol = [0,0,0,0,0,0,0,0];

        }

        console.log(currentWinLines);


        console.log("Current Spin pay total: ", currentSpinPayoutTotal);
        currentSpinWin = currentSpinPayoutTotal;

        currentWinPriceMsg.text = "$"+currentSpinWin+".00";
        balanceNum = balanceNum + currentSpinWin;
        // balanceNum
        balaceNumMsg.text = "$"+balanceNum+".00";
        currentSpinPayoutTotal = 0;
        // for(var i = 0; i < allLinePatterns.length;i++)
        // {
        //     for(var a = 0; a < allLinePatterns[i].length; a++)
        //     {
        //         console.log("Pattern: ",i,", value: ",allLinePatterns[i][a]);
        //         for(var c=0;c<possibleSymbolValueNum; c++)
        //         {
        //             if(allLinePatterns[i][a] == c+1)
        //             {
        //                 numberOfEachSymbol[c] = numberOfEachSymbol[c] + 1;
        //                 // break;
        //             }
        //         }

        //     }
        //     // for(var d = 0; d< numberOfEachSymbol.length; d++)
        //     // {
        //     //     if(numberOfEachSymbol[d] >=3)
        //     //     {
        //     //        console.log("pattern ",i+1," has one symbol of number more than 3: ",symbolNames[d],", count: ", numberOfEachSymbol[d]);
        //     //       //  break; 
        //     //     }
        //     // }
        //     // numberOfEachSymbol = [0,0,0,0,0,0,0,0];
        // }


        spinning = 0;

        spinBtnrectangle.interactive = true;
        spinBtnrectangle.buttonMode = true;

    }

  }
  else
  {
      if(showingWinLines == 1 && currentShowingWinLineNum <= currentWinLines.length - 1)
      {
        if(showWinLineTimer == 0)
        {
          // currentShowingWinLineNum
          console.log("Showing line pattern: ", currentWinLines[currentShowingWinLineNum]);

          for(var i = 0; i< allLinePatternDrawers.children.length; i++)
          {
            if(i == currentWinLines[currentShowingWinLineNum])
            {
              allLinePatternDrawers.children[i].visible = true;
              if(i<=3)
              {
                allWinMusic[i].play();
              }
              else
              {
                allWinMusic[4].play();
              }

            }
            else
            {
              allLinePatternDrawers.children[i].visible = false;
            }
          }

          currentShowingWinLineNum = currentShowingWinLineNum + 1;
          showWinLineTimer = 1;
        }
        else
        {
          if(showWinLineTimer + 1 < 150)
          {
            showWinLineTimer = showWinLineTimer + 1;
          }
          else
          {
            showWinLineTimer = 0;
          }
        }
        // showWinLineTimer
      }
  }

  // animals.x += animals.vx;
  // animals.y += animals.vy;
  // cat.vx = 1;
  // cat.x += cat.vx;
}
//Start the game loop
// gameLoop();




//The `randomInt` helper function
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}




function keyboard(keyCode) {
  var key = {};
  key.code = keyCode;
  key.isDown = false;
  key.isUp = true;
  key.press = undefined;
  key.release = undefined;
  //The `downHandler`
  key.downHandler = function(event) {
    if (event.keyCode === key.code) {
      if (key.isUp && key.press) key.press();
      key.isDown = true;
      key.isUp = false;
    }
    event.preventDefault();
  };

  //The `upHandler`
  key.upHandler = function(event) {
    if (event.keyCode === key.code) {
      if (key.isDown && key.release) key.release();
      key.isDown = false;
      key.isUp = true;
    }
    event.preventDefault();
  };

  //Attach event listeners
  window.addEventListener(
    "keydown", key.downHandler.bind(key), false
  );
  window.addEventListener(
    "keyup", key.upHandler.bind(key), false
  );
  return key;
}


function onClick () {
    // cat.scale.x *= 1.25;
    // cat.scale.y *= 1.25;
  // console.log(cat.x);


}

function onClickUp () {
    // cat.scale.x *= 1.25;
    // cat.scale.y *= 1.25;
  upButtonMusic.play();  
  betNum = betNum + 1;
  console.log("Clicked up button, betNum: ", betNum);

  betNumMsg.text = "$" + betNum.toString() + ".00";
  renderer.render(stage);

}

function onClickDown () {
    // cat.scale.x *= 1.25;
    // cat.scale.y *= 1.25;
  downButtonMusic.play();
  if(betNum - 1 > 0)
  {
    betNum = betNum - 1;

  }
  console.log("Clicked down button, betNum: ", betNum);

  betNumMsg.text = "$" + betNum.toString() + ".00";
  renderer.render(stage);


}

function onClickSpin () {
    // cat.scale.x *= 1.25;
    // cat.scale.y *= 1.25;
  console.log("Clicked spin button");
  SpinButtonMusic.play();



  if(balanceNum - betNum < 0)
  {
    console.log("Not enough balance!");
    return;  
  }
  else
  {

    for(var i=0; i< allWinMusic.length;i++)
    {
        temp = allWinMusic[i];
        temp.stop();
    }

    for(var i =0; i< allLinePatternDrawers.children.length;i++)
    {
        temp = allLinePatternDrawers.children[i];
        temp.visible = false;

    }

    balanceNum = balanceNum - betNum;
    balaceNumMsg.text = "$"+balanceNum+".00";

    reel1CurrentGeneratedSpinningRound = randomInt(1, 20);
    reel2CurrentGeneratedSpinningRound = randomInt(1, 20);
    reel3CurrentGeneratedSpinningRound = randomInt(1, 20);
    reel4CurrentGeneratedSpinningRound = randomInt(1, 20);
    reel5CurrentGeneratedSpinningRound = randomInt(1, 20);

    // currentMaxGeneratedSpinningRound = Math.max(
    // reel1CurrentGeneratedSpinningRound, 
    // reel2CurrentGeneratedSpinningRound, 
    // reel3CurrentGeneratedSpinningRound,
    // reel4CurrentGeneratedSpinningRound,
    // reel5CurrentGeneratedSpinningRound);

    // console.log("reel1CurrentGeneratedSpinningRound: ", reel1CurrentGeneratedSpinningRound);
    // console.log("reel2CurrentGeneratedSpinningRound: ", reel2CurrentGeneratedSpinningRound);
    // console.log("reel3CurrentGeneratedSpinningRound: ", reel3CurrentGeneratedSpinningRound);
    // console.log("reel4CurrentGeneratedSpinningRound: ", reel4CurrentGeneratedSpinningRound);
    // console.log("reel5CurrentGeneratedSpinningRound: ", reel5CurrentGeneratedSpinningRound);
    // console.log("currentMaxGeneratedSpinningRound: ", currentMaxGeneratedSpinningRound);

    currentWinLines = [];
    showingWinLines = 0;
    currentShowingWinLineNum = 0;
    showWinLineTimer = 0;
    spinning = 1;

  // spinBtnrectangle.interactive = true;
  // spinBtnrectangle.buttonMode = true;

    renderer.render(stage);

  }





}


function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

//Tell the `renderer` to `render` the `stage`
// renderer.render(stage);
  </script>
</body>
</html>
